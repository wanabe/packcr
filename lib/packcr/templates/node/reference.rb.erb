<%- if index != nil -%>
if !apply_rule(:evaluate_rule_<%= name %>, chunk.thunks, chunk.values, <%= index %>)
  throw(<%= onfail %>)
end
<%- else -%>
if !apply_rule(:evaluate_rule_<%= name %>, chunk.thunks, nil, 0)
  throw(<%= onfail %>)
end
<%- end -%>
