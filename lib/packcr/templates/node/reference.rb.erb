<%- if index != nil -%>
if !apply_rule(:evaluate_rule_<%= name %>, answer.thunks, answer.values, <%= index %>)
  throw(<%= onfail %>)
end
<%- else -%>
if !apply_rule(:evaluate_rule_<%= name %>, answer.thunks, nil, 0)
  throw(<%= onfail %>)
end
<%- end -%>
