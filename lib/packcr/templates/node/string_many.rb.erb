if (
  refill_buffer(<%= n %>) < <%= n %> ||
  @buffer[@cur, <%= n %>] != <%= value[0, n].dump %>
)
  throw(<%= onfail %>)
end
<%- if gen.location -%>
@cur_loc = @cur_loc.forward(@buffer, @cur, <%= n %>)
<%- end -%>
@cur += <%= n %>
