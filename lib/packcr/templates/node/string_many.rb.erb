if refill_buffer(<%= n %>) < <%= n %> ||
   @buffer[@position_offset, <%= n %>] != <%= value[0, n].dump %>

  throw(<%= onfail %>)
end
<%- if gen.location -%>
@position_offset_loc = @position_offset_loc.forward(@buffer, @position_offset, <%= n %>)
<%- end -%>
@position_offset += <%= n %>
