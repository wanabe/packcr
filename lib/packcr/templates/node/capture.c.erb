{
    const size_t p = ctx->cur;
    size_t q;
<%- if gen.location -%>
    pcc_location_t p_loc = ctx->cur_loc;
    pcc_location_t q_loc;
<%- end -%>
<%- r = expr.reachability -%>
<%- _, code = gen.generate_code_str(expr, onfail, 4, false) -%>
<%= code -%>
    q = ctx->cur;
    chunk->capts.buf[<%= index %>].range.start = p;
    chunk->capts.buf[<%= index %>].range.end = q;
<%- if gen.location -%>
    q_loc = ctx->cur_loc;
    *chunk->capts.buf[<%= index %>].range.start_loc_ptr = p_loc;
    *chunk->capts.buf[<%= index %>].range.end_loc_ptr = q_loc;
<%- end -%>
}
