<%- if a -%>
if refill_buffer(1) < 1 ||
   @buffer[@position_offset] == "<%= Packcr.escape_character(charclass[0]) %>"
  throw(<%= onfail %>)
end
<%-   if gen.location -%>
@position_offset_loc = @position_offset_loc.forward(@buffer, @position_offset, 1)
<%-   end -%>
@position_offset += 1
<%- else -%>
if refill_buffer(1) < 1 ||
   @buffer[@position_offset] != "<%= Packcr.escape_character(charclass[0]) %>"
  throw(<%= onfail %>)
end
<%-   if gen.location -%>
@position_offset_loc = @position_offset_loc.forward(@buffer, @position_offset, 1)
<%-   end -%>
@position_offset += 1
<%- end -%>
