<%- if a -%>
if (
  refill_buffer(1) < 1 ||
  @buffer[@cur] == "<%= Packcr.escape_character(charclass[0]) %>"
)
  throw(<%= onfail %>)
end
<%-   if gen.location -%>
@cur_loc.forward(@buffer, @cur, 1)
<%-   end -%>
@cur += 1
<%- else -%>
if (
  refill_buffer(1) < 1 ||
  @buffer[@cur] != "<%= Packcr.escape_character(charclass[0]) %>"
)
  throw(<%= onfail %>)
end
<%-   if gen.location -%>
@cur_loc.forward(@buffer, @cur, 1)
<%-   end -%>
@cur += 1
<%- end -%>
