if refill_buffer(1) >= 1
  throw(<%= onfail %>)
end
